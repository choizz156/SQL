# over 절

- over절은 분석함수 바로 뒤에 사용하며, 분석 대상을 지정
- count, sum, min ,max와 같은 분석함수는 집계함수와 명칭과 기능이 같지만 분석을 수행하는 대상이 다름.
  - over 절이 있으면 분석함수고 그렇지 않으면 집계함수

> - over 절
>   - 분석함수의 분석 대상을 정하는 역할
>   - 대부분의 분석함수는 over 절과 같이 사용
>   - over ()와 같이 괄호 안에 아무런 옵션을 주지 않으면 조회된 결과 전체가 분석 대상

```sql
-- 오류 문장
select t1.ORD_SEQ, t1.CUS_ID, t1.ORD_DT, count(*)
from T_ORD t1
where t1.ORD_DT >= to_date('20170301', 'YYYYMMDD')
and t1.ORD_DT < to_date('20170302', 'YYYYMMDD');

-- 통과
select t1.ORD_SEQ, t1.CUS_ID, t1.ORD_DT, count(*) over()
from T_ORD t1
where t1.ORD_DT >= to_date('20170301', 'YYYYMMDD')
and t1.ORD_DT < to_date('20170302', 'YYYYMMDD');
```

- 첫 번째 문의 count(*)는 집계함수 -> select 되는 다른 컬럼과 사용할 수 없음.
- 두 번째 문의 count(\*) over()를 추가하면 count(\*)는 분석함수로 작동함.
  </br>
- over()는 분석 대상을 지정하는 기능을 함 -> 괄호 안에 별다른 옵션을 주지 않으면 조회가 완료된 결과 전체가 분석 대상.
- over 절 안에 'PRATITION BY'나 'ORDER BY'를 사용하면 각 로우마다 분석 대상을 다르게 설정할 수 있음.

## 분석 대상

- 과정
  - from 절: 대상 테이블 선택
  - where 절: 1번의 대상 중에 조회할 데이터를 선택
  - group by: 2번까지 수행된 결과를 그룹화
  - having 절: 3번 까지 수행된 결과 중 최종 조회될 데이터 선택
- <u>over 절의 분석 대상은 위 과정이 모두 종료된 결과 집합</u>

